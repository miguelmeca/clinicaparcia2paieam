<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	template="/templates/templateFuncionario.xhtml"
	xmlns:a4j="http://richfaces.org/a4j">


	<ui:define name="cuerpo">

		<!-- Formulario para buscar la formula medica -->
		<h:form>
			<h1>
				<h:outputLabel value="#{msg['entregarFormulaMedica.titulo']}" />
			</h1>
			<rich:panel>

				<h:panelGrid columns="3">

					<!-- Campo para mostrar el usuario en sesion -->
					<h:outputText value="#{msg['entregarFormulaMedica.usuario']}" />
					<h:outputText value="#{msg['entregarFormulaMedica.cantidad']}" />
					<h:outputText value="" />

					<!-- Campo para buscar la formula medica y cargar los detalles en la tabla -->
					<h:outputText value="#{msg['entregarFormulaMedica.codigoFormula']}" />
					<h:inputText value="#{entregarFormulaMedicaBean.codFormula}" />

					<a4j:commandButton
						action="#{entregarFormulaMedicaBean.buscarFormulaMedica}"
						value="#{msg['entregarFormulaMedica.buscar']}"
						reRender="tablaMedicamentos"></a4j:commandButton>

				</h:panelGrid>
			</rich:panel>
			<br />
			<br />


			<rich:dataTable id="tablaMedicamentos"
				value="#{entregarFormulaMedicaBean.detalles}" var="detalle">

				<rich:column>
					<f:facet name="header">
						<h:outputLabel
							value="#{msg['entregarFormulaMedica.idMedicamento']}" />
					</f:facet>
					<h:outputText value="#{detalle.articulo.id}" />
				</rich:column>

				<rich:column>
					<f:facet name="header">
						<h:outputLabel
							value="#{msg['entregarFormulaMedica.nombreMedicamento']}" />
					</f:facet>
					<h:outputText value="#{detalle.articulo.primerNombre}" />
				</rich:column>

				<rich:column>
					<f:facet name="header">
						<h:outputLabel value="#{msg['entregarFormulaMedica.cantidad']}" />
					</f:facet>
					<h:outputText value="#{detalle.cantidad}" />
				</rich:column>

				<rich:column>
					<a4j:commandLink ajaxSingle="true" id="link"
						oncomplete="#{rich:component('panelMedicamento')}.show()">
						<h:graphicImage value="/imgs/why-choose-us.png" height="20" width="20"/>
					</a4j:commandLink>
					<rich:toolTip for="link"
						value="#{msg['entregarFormulaMedica.modal']}" />
				</rich:column>
			</rich:dataTable>
		</h:form>

		<h:form>
			<rich:modalPanel id="panelMedicamento" autosized="true" width="200">
				<f:facet name="header">
					<h:outputText value="#{msg['entregarFormulaMedica.texto']}"
						style="padding-right:15px;" />
				</f:facet>
				<f:facet name="controls">
					<h:panelGroup>
						<h:graphicImage value="/imgs/close.png" styleClass="hidelink"
							id="hidelink" />
						<rich:componentControl for="panelMedicamento" attachTo="hidelink"
							operation="hide" event="oncomplete" />
					</h:panelGroup>
				</f:facet>
				<h:form>
					<table width="100%">
						<tbody>
							<tr>

								<td align="center" width="50%">
								<h:outputLabel value="#{msg['entregarFormulaMedica.codigoBarras']}" />
								<h:inputText value="#{entregarFormulaMedicaBean.codigoBarras}" />
								</td>
								<td align="center" width="50%">
								<a4j:commandButton
										value="#{msg['entregarFormulaMedica.validar']}"
										ajaxSingle="true"
										action="#{entregarFormulaMedicaBean.validarMedicamento}"
										oncomplete="#{rich:component('panelMedicamento')}.hide();"
										reRender="tablaMedicamentosAdd" />
										</td>
							</tr>
						</tbody>
					</table>
				</h:form>
			</rich:modalPanel>
		</h:form>
		
		<rich:dataTable id="tablaMedicamentosAdd"
				value="#{entregarFormulaMedicaBean.detalles}" var="detalle">

				<rich:column>
					<f:facet name="header">
						<h:outputLabel
							value="#{msg['entregarFormulaMedica.idMedicamento']}" />
					</f:facet>
					<h:outputText value="#{detalle.articulo.id}" />
				</rich:column>

				<rich:column>
					<f:facet name="header">
						<h:outputLabel
							value="#{msg['entregarFormulaMedica.nombreMedicamento']}" />
					</f:facet>
					<h:outputText value="#{detalle.articulo.primerNombre}" />
				</rich:column>

				<rich:column>
					<f:facet name="header">
						<h:outputLabel value="#{msg['entregarFormulaMedica.cantidad']}" />
					</f:facet>
					<h:outputText value="#{detalle.cantidad}" />
				</rich:column>

				<rich:column>
					<a4j:commandLink ajaxSingle="true" id="link"
						oncomplete="#{rich:component('panelMedicamento')}.show()">
						<h:graphicImage value="agregar" style="border:0" />
						<!--  <f:setPropertyActionListener value="#{row}" target="#{dataTableScrollerBean.currentRow}" /> -->
						<!--<a4j:actionparam name="#{msg['entregarFormulaMedica.codigoBarras']}" value="#{entregarFormulaMedicaBean.}"/>-->
					</a4j:commandLink>
					<rich:toolTip for="link"
						value="#{msg['entregarFormulaMedica.modal']}" />
				</rich:column>
			</rich:dataTable>
	</ui:define>

</ui:composition>